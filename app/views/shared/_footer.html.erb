<!-- app/views/shared/_footer.html.erb -->
<% if user_signed_in? %>
  <!-- ログイン後：ボトムナビ（safe-area対応 & アクセシビリティ強化） -->
  <footer class="bg-brand-header text-white">
    <div class="footer-app footer-thick mx-auto max-w-[1200px] px-4 md:px-6 pb-safe">
      <nav class="footer-app__nav" aria-label="アプリフッター・メインナビゲーション" role="navigation">

        <!-- 記録一覧 -->
        <%= link_to (respond_to?(:fasting_records_path) ? fasting_records_path : "#"),
          class: "footer-app__link #{(respond_to?(:fasting_records_path) && current_page?(fasting_records_path)) ? 'is-active' : ''}",
          aria: { label: "記録一覧", current: ((respond_to?(:fasting_records_path) && current_page?(fasting_records_path)) ? 'page' : nil) } do %>
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M15.232 5.232a2.5 2.5 0 0 1 3.536 3.536l-8.5 8.5-4.268.732.732-4.268 8.5-8.5Z M4 20h16v2H4z" fill="currentColor"/>
          </svg>
          <span>記録一覧</span>
        <% end %>

        <!-- カレンダー -->
        <%= link_to (respond_to?(:calendar_fasting_records_path) ? calendar_fasting_records_path : "#"),
          class: "footer-app__link #{(respond_to?(:calendar_fasting_records_path) && current_page?(calendar_fasting_records_path)) ? 'is-active' : ''}",
          aria: { label: "カレンダー", current: ((respond_to?(:calendar_fasting_records_path) && current_page?(calendar_fasting_records_path)) ? 'page' : nil) } do %>
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <rect x="3" y="4" width="18" height="16" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="1.8"/>
            <path d="M3 9h18" fill="none" stroke="currentColor" stroke-width="1.8"/>
            <path d="M8 2v4M16 2v4" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
            <!-- 小さな日付ドット（視覚的な“月表示”の雰囲気） -->
            <circle cx="8"  cy="13.5" r="1" fill="currentColor"/>
            <circle cx="12" cy="13.5" r="1" fill="currentColor"/>
            <circle cx="16" cy="13.5" r="1" fill="currentColor"/>
            <circle cx="8"  cy="17.5" r="1" fill="currentColor"/>
            <circle cx="12" cy="17.5" r="1" fill="currentColor"/>
            <circle cx="16" cy="17.5" r="1" fill="currentColor"/>
          </svg>
          <span>カレンダー</span>
        <% end %>

        <!-- 瞑想 -->
        <%= link_to (respond_to?(:meditations_path) ? meditations_path : "#"),
          class: "footer-app__link #{(respond_to?(:meditations_path) && current_page?(meditations_path)) ? 'is-active' : ''}",
          aria: { label: "瞑想", current: ((respond_to?(:meditations_path) && current_page?(meditations_path)) ? 'page' : nil) } do %>
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M12 4.8c2.0 2.2 3.0 4.2 3.0 6.0c-1.6.8-3.0.8-3.0.8s-1.4 0-3.0-.8c0-1.8 1.0-3.8 3.0-6.0Z"
                  fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
            <path d="M6.5 7.4c.9 2.2 2.4 3.7 4.6 4.7c-2.3.8-4.2.7-6.1-.1c.1-1.7.6-3.2 1.5-4.6Z"
                  fill="none" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"/>
            <path d="M17.5 7.4c-.9 2.2-2.4 3.7-4.6 4.7c2.3.8 4.2.7 6.1-.1c-.1-1.7-.6-3.2-1.5-4.6Z"
                  fill="none" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"/>
            <path d="M4 18c5.3 1.4 10.7 1.4 16 0"
                  fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
          </svg>
          <span>瞑想</span>
        <% end %>

        <!-- 食事提案（AI回復食コンシェルジュ） -->
        <%= link_to (respond_to?(:meal_suggestion_path) ? meal_suggestion_path : "#"),
          class: "footer-app__link #{(respond_to?(:meal_suggestion_path) && current_page?(meal_suggestion_path)) ? 'is-active' : ''}",
          aria: { label: "食事提案", current: ((respond_to?(:meal_suggestion_path) && current_page?(meal_suggestion_path)) ? 'page' : nil) } do %>
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <!-- フォーク -->
            <path d="M7 4v4.5M9 4v4.5M11 4v4.5"
                  fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"/>
            <path d="M7 8.5c0 1.8.4 2.6.4 4.3V19"
                  fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M11 8.5c0 1.8-.4 2.6-.4 4.3V19"
                  fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <!-- スプーン -->
            <path d="M16.5 4.5a2.8 2.8 0 0 1 2.8 2.8c0 1.5-1 2.7-2.1 3.2v8.5"
                  fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span>食事</span>
        <% end %>

        <!-- マイページ -->
        <%= link_to (respond_to?(:mypage_path) ? mypage_path : "#"),
          class: "footer-app__link #{(respond_to?(:mypage_path) && current_page?(mypage_path)) ? 'is-active' : ''}",
          aria: { label: "マイページ", current: ((respond_to?(:mypage_path) && current_page?(mypage_path)) ? 'page' : nil) } do %>
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm-8 8a8 8 0 0 1 16 0v1H4z" fill="currentColor"/>
          </svg>
          <span>マイページ</span>
        <% end %>

      </nav>
    </div>
  </footer>

<% else %>
  <!-- ログイン前：極細・法務リンクのみ（safe-area対応） -->
  <footer class="bg-brand-header text-white">
    <div class="footer-legal-thin mx-auto max-w-[1200px] px-4 md:px-6 pb-safe">
      <div class="legal-wrap flex items-center justify-between gap-3 sm:gap-4 w-full">
        <p class="copyright select-none whitespace-nowrap text-[0.8rem] leading-none opacity-95">
          &copy; <%= Time.zone.now.year %> Fasty
        </p>
        <nav class="legal-links ml-auto flex items-center gap-3 sm:gap-5 whitespace-nowrap" aria-label="法務リンク" role="navigation">
          <%= link_to "健康と安全", health_notice_path, class: "opacity-95 hover:opacity-100 hover:underline" %>
          <%= link_to "利用規約", (respond_to?(:terms_path) ? terms_path : "#"), class: "opacity-95 hover:opacity-100 hover:underline" %>
          <%= link_to "お問い合わせ", (respond_to?(:contact_path) ? contact_path : "#"), class: "opacity-95 hover:opacity-100 hover:underline" %>
          <%= link_to "プライバシーポリシー", (respond_to?(:privacy_path) ? privacy_path : "#"), class: "opacity-95 hover:opacity-100 hover:underline" %>
        </nav>
      </div>
    </div>
  </footer>
<% end %>
