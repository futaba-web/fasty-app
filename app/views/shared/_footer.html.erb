<!-- app/views/shared/_footer.html.erb -->
<% if user_signed_in? %>
  <!-- ログイン後：ボトムナビ（safe-area対応 & アクセシビリティ強化） -->
  <footer class="bg-brand-header text-white">
    <div class="footer-app footer-thick mx-auto max-w-[1200px] px-4 md:px-6 pb-safe">
      <nav class="footer-app__nav" aria-label="アプリフッター・メインナビゲーション" role="navigation">

        <!-- 記録一覧 -->
        <%= link_to (respond_to?(:fasting_records_path) ? fasting_records_path : "#"),
          class: "footer-app__link #{(respond_to?(:fasting_records_path) && current_page?(fasting_records_path)) ? 'is-active' : ''}",
          aria: { label: "記録一覧", current: ((respond_to?(:fasting_records_path) && current_page?(fasting_records_path)) ? 'page' : nil) } do %>
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M15.232 5.232a2.5 2.5 0 0 1 3.536 3.536l-8.5 8.5-4.268.732.732-4.268 8.5-8.5Z M4 20h16v2H4z" fill="currentColor"/>
          </svg>
          <span>記録一覧</span>
        <% end %>

        <!-- 瞑想 -->
        <%= link_to (respond_to?(:meditations_path) ? meditations_path : "#"),
          class: "footer-app__link #{(respond_to?(:meditations_path) && current_page?(meditations_path)) ? 'is-active' : ''}",
          aria: { label: "瞑想", current: ((respond_to?(:meditations_path) && current_page?(meditations_path)) ? 'page' : nil) } do %>
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M12 4.8c2.0 2.2 3.0 4.2 3.0 6.0c-1.6.8-3.0.8-3.0.8s-1.4 0-3.0-.8c0-1.8 1.0-3.8 3.0-6.0Z"
                  fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
            <path d="M6.5 7.4c.9 2.2 2.4 3.7 4.6 4.7c-2.3.8-4.2.7-6.1-.1c.1-1.7.6-3.2 1.5-4.6Z"
                  fill="none" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"/>
            <path d="M17.5 7.4c-.9 2.2-2.4 3.7-4.6 4.7c2.3.8 4.2.7 6.1-.1c-.1-1.7-.6-3.2-1.5-4.6Z"
                  fill="none" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"/>
            <path d="M4 18c5.3 1.4 10.7 1.4 16 0"
                  fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
          </svg>
          <span>瞑想</span>
        <% end %>

        <!-- マイページ -->
        <%= link_to (respond_to?(:mypage_path) ? mypage_path : "#"),
          class: "footer-app__link #{(respond_to?(:mypage_path) && current_page?(mypage_path)) ? 'is-active' : ''}",
          aria: { label: "マイページ", current: ((respond_to?(:mypage_path) && current_page?(mypage_path)) ? 'page' : nil) } do %>
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm-8 8a8 8 0 0 1 16 0v1H4z" fill="currentColor"/>
          </svg>
          <span>マイページ</span>
        <% end %>

      </nav>
    </div>
  </footer>

<% else %>
  <!-- ログイン前：極細・法務リンクのみ（safe-area対応） -->
  <footer class="bg-brand-header text-white">
    <div class="footer-legal-thin mx-auto max-w-[1200px] px-4 md:px-6 pb-safe">
      <div class="legal-wrap flex items-center justify-between gap-3 sm:gap-4 w-full">
        <p class="copyright select-none whitespace-nowrap text-[0.8rem] leading-none opacity-95">
          &copy; <%= Time.zone.now.year %> Fasty
        </p>
        <nav class="legal-links ml-auto flex items-center gap-3 sm:gap-5 whitespace-nowrap" aria-label="法務リンク" role="navigation">
          <%= link_to "健康と安全", health_notice_path, class: "opacity-95 hover:opacity-100 hover:underline" %>
          <%= link_to "利用規約", (respond_to?(:terms_path) ? terms_path : "#"), class: "opacity-95 hover:opacity-100 hover:underline" %>
          <%= link_to "お問い合わせ", (respond_to?(:contact_path) ? contact_path : "#"), class: "opacity-95 hover:opacity-100 hover:underline" %>
          <%= link_to "プライバシーポリシー", (respond_to?(:privacy_path) ? privacy_path : "#"), class: "opacity-95 hover:opacity-100 hover:underline" %>
        </nav>
      </div>
    </div>
  </footer>
<% end %>
