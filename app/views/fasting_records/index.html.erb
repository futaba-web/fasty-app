<%# app/views/fasting_records/index.html.erb %>

<% raw_cur = params[:status].presence %>
<% cur     = normalized_status_param(raw_cur) %>

<!-- スティッキーヘッダー：背景なし（透明）＋ノッチ安全域 -->
<div class="sticky top-[env(safe-area-inset-top)] z-50">
  <div class="grid grid-cols-[1fr,auto,1fr] items-center py-2">
    <!-- 左ダミー -->
    <div></div>

    <!-- 中央：タイトルのみ（常に中央寄せ） -->
    <h1 class="justify-self-center text-base sm:text-2xl font-bold whitespace-nowrap">
      ファスティング記録一覧
    </h1>

    <!-- 右：プルダウンのみ（ラベル非表示） -->
    <div class="justify-self-end">
      <%= render "shared/filter_dropdown",
            url: fasting_records_path,
            param: :status,
            current: cur,
            options: status_filter_options,
            label: nil,                       # ラベルは表示しない
            wrapper_class: "inline-block shrink-0" %>
    </div>
  </div>
</div>

<!-- 本文ラッパ：余白・縦スペースはここで管理（レイアウトのコンテナ内） -->
<div class="space-y-6 sm:space-y-8">
  <% if @records.blank? %>
    <div class="rounded-2xl border border-black/10 bg-white p-6 text-center text-black/70">
      まだ記録がありません。<br class="sm:hidden">
      <%= link_to "マイページからファスティングを開始",
                  mypage_path,
                  class: "text-blue-600 hover:text-blue-700 underline font-medium" %>
    </div>
  <% else %>
    <!-- 各行の高さを固定（モバイル少し低め→sm/ mdで段階UP） -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4 auto-rows-[120px] sm:auto-rows-[132px] md:auto-rows-[144px]">
      <%= render partial: "record", collection: @records, as: :record %>
    </div>

    <% if defined?(Kaminari) && @records.respond_to?(:current_page) %>
      <div class="mt-6 flex justify-center md:justify-start">
        <%= paginate @records, params: { status: params[:status] } %>
      </div>
    <% end %>
  <% end %>
</div>
