<%# app/views/fasting_records/index.html.erb %>

<% raw_cur = params[:status].presence %>
<% cur     = normalized_status_param(raw_cur) %>

<!-- スティッキーヘッダー -->
<div class="sticky top-0 z-50 bg-white/90 backdrop-blur">
  <!-- ← ここを relative にして、絶対配置の基準にする -->
  <div class="relative max-w-4xl mx-auto px-4 py-2">
    <!-- タイトルは中央寄せだけにしてOK（中央に“見える”のが目的） -->
    <h1 class="text-center text-lg sm:text-xl font-bold">
      ファスティング記録一覧
    </h1>

    <!-- 右端：絞り込み（絶対配置で right 固定＆縦中央） -->
    <%= render "shared/filter_dropdown",
          url: fasting_records_path,
          param: :status,
          current: cur,
          options: status_filter_options,
          label: "絞り込み",
          wrapper_class: "",
          wrapper_style: "position:absolute; right:30px; top:50%; transform:translateY(-50%);" %>
  </div>
</div>

<div class="max-w-4xl mx-auto p-4 space-y-6">
  <% if @records.blank? %>
    <div class="rounded-lg ring-1 ring-gray-200 bg-white/70 p-6 text-center text-gray-600">
      まだ記録がありません。<br class="sm:hidden">
      <%= link_to "マイページからファスティングを開始", mypage_path, class: "text-blue-600 hover:text-blue-700 underline font-medium" %>
    </div>
  <% else %>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <%= render partial: "record", collection: @records, as: :record %>
    </div>

    <% if defined?(Kaminari) && @records.respond_to?(:current_page) %>
      <div class="mt-6 flex justify-center md:justify-start">
        <%= paginate @records, params: { status: params[:status] } %>
      </div>
    <% end %>
  <% end %>
</div>
