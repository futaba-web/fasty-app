<%# レイアウト側の大枠ボーダー/リングを無効化（対応している場合のみ効く） %>
<% content_for(:page_frame_class) { "ring-0 border-0 p-0 sm:p-0" } rescue nil %>

<div class="w-full min-h-[40vh] flex items-start sm:items-center justify-center py-8 sm:py-12">
  <div class="w-full max-w-xl rounded-2xl bg-white/90 backdrop-blur shadow-2xl ring-1 ring-gray-200 p-6 sm:p-8">

    <!-- 見出し + サブ見出し -->
    <h1 class="text-lg sm:text-xl font-bold text-center tracking-tight">長時間のファスティングについて</h1>
    <p class="mt-1 text-center text-xs sm:text-sm text-gray-500">
      目標時間：<strong><%= @hours %>時間</strong>
    </p>

    <!-- 本文（中央寄せ、箇条書きは inline-block で自然な左右幅） -->
    <div class="mt-5 sm:mt-6 text-sm sm:text-base text-gray-700 text-center">
      <p class="mb-2">以下の注意事項を必ず確認してください。</p>
      <ul class="inline-block text-left list-disc pl-5 space-y-1">
        <li>水分・電解質の補給を忘れないでください。</li>
        <li>体調不良時は直ちに中止してください。</li>
      </ul>

      <% if @very_long %>
        <div class="mt-4 sm:mt-5 rounded-md border border-rose-300 bg-rose-50 text-rose-800 p-3 text-left inline-block">
          <p class="font-semibold">24時間以上のファスティングは特に注意が必要です。</p>
          <p class="text-sm mt-1">無理をせず、体調に異変があればすぐに中止してください。</p>
        </div>
      <% end %>
    </div>

    <%= form_with url: start_fasting_records_path, method: :post, local: true,
          html: { id: "long-notice-form", class: "mt-6 sm:mt-7 space-y-4" } do %>
      <%= hidden_field_tag :target_hours, @hours %>
      <%= hidden_field_tag :confirmed_long_notice, "1" %>

      <!-- 同意チェック（中央寄せ） -->
      <div class="flex items-center justify-center gap-2">
        <%= check_box_tag :agree_long, "1", false, id: "agree_long", class: "mt-0.5" %>
        <label for="agree_long" class="text-sm text-gray-800">上記の注意点を理解しました（同意する）</label>
      </div>

      <!-- ボタン（中央寄せ） -->
      <div class="mt-5 text-center">
        <%= button_tag "同意して開始する",
              type: :submit,
              id: "agree-long-submit",
              class: "btn btn-primary px-6 py-2 text-sm",
              disabled: true,
              aria: { disabled: true } %>
      </div>
    <% end %>
  </div>
</div>

<%= javascript_tag nonce: true do %>
  (function () {
    function init() {
      var cb  = document.getElementById('agree_long');
      var btn = document.getElementById('agree-long-submit');
      if (!cb || !btn) return;
      function sync() {
        var on = cb.checked;
        btn.disabled = !on;
        btn.setAttribute('aria-disabled', String(!on));
      }
      cb.addEventListener('change', sync);
      sync();
    }
    document.addEventListener('turbo:load', init);
    document.addEventListener('DOMContentLoaded', init);
  })();
<% end %>
