/* =========================================================
   landing.css  — Fasty
   全面背景（cover）+ ぼかしオーバーレイ / ヒーロー / Auth / 共通UI
   - Tailwind v4 (CSS) を前提 (@apply / @layer OK)
   - 画像URLは CSSカスタムプロパティ --hero-bg を優先
     （layout の <body style="--hero-bg: url('...')"> で上書き）
   ========================================================= */

/* ========================= Base / 背景とリセット ========================= */
@layer base {
  :root {
    --hero-blur: 3.5px;        /* 4〜7px で調整可 */
    --hero-fog: .05;         /* 画面全体の白ベール濃度(0〜.15) */
    --hero-veil-alpha: .28;  /* 中央ハイライトの白さ */
    --hero-veil-w: 1000px;   /* 楕円幅 */
    --hero-veil-h: 460px;    /* 楕円高さ */
  }
  @media (min-width: 768px) {
    :root { --hero-blur: 4px; --hero-fog: .06; }
  }

  /* レイアウト安定用：余白リセット */
  html, body { margin: 0; padding: 0; }

  /* 背景（最背面）— body.landing-root / .hero-bg どちらでも効くように */
  body.landing-root::before,
  body.hero-bg::before {
    content: "";
    position: fixed; inset: 0; z-index: -2; pointer-events: none;

    background-image: var(--hero-bg, url("/assets/landing/hero.jpg"));
    background-size: cover;            /* ← 途切れ防止 */
    background-position: center;
    background-repeat: no-repeat;

    transform: scale(1.04);
    filter: contrast(1.03) brightness(1.02) saturate(0.96);
  }

  /* ぼかし＆白ベール（前面オーバーレイ） */
  body.landing-root::after,
  body.hero-bg::after {
    content: "";
    position: fixed; inset: 0; z-index: -1; pointer-events: none;

    backdrop-filter: blur(var(--hero-blur));
    -webkit-backdrop-filter: blur(var(--hero-blur));

    background:
      radial-gradient(
        ellipse var(--hero-veil-w) var(--hero-veil-h) at 50% 45%,
        rgba(255,255,255,var(--hero-veil-alpha)) 0%,
        rgba(255,255,255,calc(var(--hero-veil-alpha) - .12)) 42%,
        rgba(255,255,255,0) 68%
      ),
      linear-gradient(
        to bottom,
        rgba(255,255,255,.14) 0%,
        rgba(255,255,255,.06) 30%,
        rgba(255,255,255,0)   60%
      ),
      rgba(255,255,255,var(--hero-fog));
  }

  /* コンテンツは前面へ（重なり順の安定化） */
  header, main, footer { position: relative; z-index: 1; }
}

/* ========================= Hero / ランディング要素 ========================= */
@layer components {
  .hero {
    @apply relative isolate w-full flex items-center justify-center;
    @apply min-h-[72svh] sm:min-h-[68svh];
  }
  .hero__inner { @apply relative z-10 w-full mx-auto max-w-[960px] px-6 text-center text-gray-900; }
  .hero__title { @apply select-none text-white text-4xl md:text-5xl lg:text-6xl font-extrabold tracking-wide drop-shadow-[0_6px_12px_rgba(0,0,0,0.5)]; }

  .hero__copy,
  .hero__list {
    text-shadow:
      0 1px 0 rgba(255,255,255,.85),
      0 0 10px rgba(255,255,255,.25);
  }
  .hero__copy  { @apply mt-6 md:mt-8 text-xl md:text-2xl font-extrabold leading-snug; }
  .hero__list  { @apply mt-4 space-y-2 text-lg md:text-xl font-bold; }
  .hero__cta   { @apply mt-8 flex flex-wrap items-center justify-center gap-4 md:gap-6; }

  /* ミント系ボタン（既存流用） */
  .btn-mint     { @apply inline-flex items-center justify-center rounded-full px-5 py-3 md:py-3 font-bold text-white; background:#2bd4c3; }
  .btn-mint--lg { @apply w-[180px] md:w-[220px] lg:w-[320px] text-lg md:text-xl lg:text-2xl; }
}

/* ===== Buttons (共通) ===== */
@layer components {
  .btn {
    @apply inline-flex items-center justify-center font-semibold
           rounded-3xl shadow-2xl transition-all duration-200
           focus-visible:outline-none focus-visible:ring-4
           disabled:opacity-50 disabled:cursor-not-allowed;
  }
  .btn-cta {
    @apply w-full max-w-4xl py-10 sm:py-12 px-16 sm:px-20
           text-3xl sm:text-4xl font-extrabold tracking-wide;
  }
  .btn-primary { @apply text-white bg-emerald-600 hover:bg-emerald-700 focus-visible:ring-emerald-200/70; }
  .btn-danger  { @apply text-white bg-rose-600    hover:bg-rose-700    focus-visible:ring-rose-200/70; }
}

/* ===== Utilities / 色など ===== */
@layer utilities {
  .btn-mint       { transition: transform .15s ease, box-shadow .15s ease; box-shadow: 0 10px 30px rgba(43,212,195,.35); }
  .btn-mint:hover { transform: translateY(-1.5px); box-shadow: 0 14px 34px rgba(43,212,195,.45); }
  .btn-cta:active { transform: scale(0.99); }

  .bg-brand-header        { background-color: #bdb6b2; }
  .bg-brand-header--light { background-color: #c4bdbb; }
  .bg-brand-header--dark  { background-color: #a9a3a0; }
}

/* ===== 共通パーツ ===== */
@layer components {
  .btn-outline {
    @apply inline-flex items-center justify-center rounded-full
           border-2 border-white/80 text-white/90
           px-8 py-4 md:py-5 font-bold backdrop-blur-sm
           hover:bg-white/10 transition;
  }
  .badge-soft { @apply px-3 py-1 rounded-full bg-white/70 backdrop-blur text-gray-800 shadow-sm; }
}

/* ========================= Auth（ログイン等） ========================= */
@layer components {
  /* Devise画面にも cover を適用するための保険クラス */
  .auth-bg { @apply relative min-h-[100svh] bg-center bg-cover bg-no-repeat; background-image: var(--hero-bg, url("/assets/landing/hero.jpg")); }
  .auth-dim { @apply absolute inset-0 bg-black/30; }
  .auth-center { @apply relative min-h-[100svh] flex items-center justify-center p-4 sm:p-6 md:p-10; }
  .auth-card { @apply w-full max-w-[680px] md:max-w-[720px] rounded-2xl bg-white/65 backdrop-blur-md shadow-2xl ring-1 ring-black/10 p-6 md:p-8 lg:p-10 bg-gradient-to-b from-white/80 to-white/55 border border-white/50; }
  .auth-title { font-size: clamp(1.5rem, 3.5vw, 2.25rem); line-height: 1.2; letter-spacing: 0.02em; }
  .devise-links { @apply mt-6 text-center space-y-2; }
  .devise-links a { @apply text-blue-600 hover:text-blue-700 underline underline-offset-4; }
}

/* ========================= MyPage 背景（やさしいグラデ） ========================= */
@layer components {
  .mypage-bg { position: relative; min-height: 100svh; }
  .mypage-bg::before {
    content: ""; position: fixed; inset: 0; z-index: -1;
    background:
      radial-gradient(1100px 520px at 50% 0%, rgba(59,130,246,0.06) 0%, rgba(59,130,246,0.00) 55%),
      linear-gradient(180deg, #fafafa 0%, #f7f5f2 60%, #f4f1ed 100%);
  }
}

/* ========================= 既存 landing セクション互換 ========================= */
@layer components {
  .landing-bg {
    @apply bg-center bg-cover bg-no-repeat;
    background-image: var(--hero-bg, url("/assets/landing/hero.jpg"));
  }
  .home-hero       { @apply min-h-[72svh] sm:min-h-[68svh] relative; }
  .home-hero-title { @apply text-4xl md:text-5xl lg:text-6xl; }
  .home-hero-copy  { @apply text-xl md:text-2xl leading-snug; }
  .home-hero-list  { @apply mt-4 space-y-2 text-lg md:text-xl; }
  .home-hero-cta   { @apply mt-8 flex flex-wrap items-center justify-center gap-4 md:gap-6; }
  .btn-cta-sm      { @apply rounded-full w-[200px] md:w-[220px] px-6 py-4 text-xl md:text-2xl; }
}

/* ========================= “謎の空白”ケア ========================= */
@layer base {
  main { margin-top: 0 !important; padding-top: 0 !important; }
  main > :first-child { margin-top: 0 !important; }
}

/* ========================= Landing Hero v2 ========================= */
@layer components {
  .landing-hero-v2{
    position: relative; z-index: 1;
    max-width: 980px;
    margin: clamp(24px, 6vh, 48px) auto;
    padding: 0 clamp(16px, 4vw, 32px);
    text-align: center;
    color: #1f2937; /* text-gray-800 */
  }

  .landing-hero-v2__logo{
    font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    font-weight: 800; letter-spacing: .03em;
    font-size: clamp(28px, 5vw, 44px);
    color: #ffffff;
    text-shadow: 0 6px 12px rgba(0,0,0,.35);
    margin: 0 0 clamp(14px, 2.4vh, 20px);
  }

  .landing-hero-v2__catch{
    font-weight: 800; letter-spacing: .02em; line-height: 1.25;
    margin: 0 auto clamp(18px, 3vh, 24px);
    font-size: clamp(24px, 4.8vw, 40px);
    color: #111827; /* text-gray-900 */
    text-shadow: 0 1px 0 rgba(255,255,255,.75);
  }

  .landing-hero-v2__points{
    list-style: none; padding: 0;
    margin: 0 auto clamp(18px, 3vh, 24px);
    max-width: 780px; text-align: left;
    font-size: clamp(16px, 2.5vw, 20px); font-weight: 700;
  }
  .landing-hero-v2__points li{
    display: flex; align-items: flex-start; gap: .5rem;
    padding: 6px 0;
  }
  .landing-hero-v2__points li::before{
    content: "✅"; flex: 0 0 auto; transform: translateY(1px);
  }

  .landing-hero-v2__note{
    margin: clamp(8px, 1.8vh, 12px) auto clamp(18px, 3.2vh, 26px);
    font-size: clamp(11px, 1.8vw, 13px);
    color: #4b5563; /* text-gray-600 */
    text-shadow: 0 1px 0 rgba(255,255,255,.5);
  }

  .landing-hero-v2__cta{
    display: flex; justify-content: center;
    gap: clamp(16px, 4vw, 28px); flex-wrap: wrap;
  }

  .hero-btn{
    border-radius: 9999px;
    padding: clamp(12px, 2.2vh, 16px) clamp(24px, 6vw, 40px);
    min-width: clamp(220px, 26vw, 320px);
    font-size: clamp(18px, 2.8vw, 26px);
    font-weight: 800; letter-spacing: .04em;
    box-shadow: 0 10px 30px rgba(0,0,0,.08);
    transition: transform .15s ease, box-shadow .15s ease, background-color .2s ease, color .2s ease, border-color .2s ease;
  }
  .hero-btn:active{ transform: scale(.99); }

  .hero-btn--signup{
    color: #fff; background: #2bd4c3; border: 2px solid transparent;
  }
  .hero-btn--signup:hover{
    filter: brightness(1.05); box-shadow: 0 14px 34px rgba(43,212,195,.35);
  }

  .hero-btn--login{
    color: #2bb7a9; background: rgba(255,255,255,.7);
    border: 3px solid #2bb7a9; backdrop-filter: blur(2px);
  }
  .hero-btn--login:hover{
    background: rgba(255,255,255,.9); box-shadow: 0 12px 28px rgba(43,212,195,.18);
  }
}

/* ========================= Fasting Records: アイコン等 ========================= */
@layer components {
  .icon-btn {
    display: inline-flex; align-items: center; justify-content: center;
    width: 36px; height: 36px; border-radius: 0.5rem;
    background: #fff; border: 1px solid #e5e7eb; color: #374151;
    transition: background-color .15s, border-color .15s;
  }
  .icon-btn:hover { background: #f9fafb; }
  .icon-btn--danger { border-color: #fca5a5; color: #b91c1c; background: #fff; }
  .icon-btn--danger:hover { background: #fff1f2; }
  .icon { width: 16px; height: 16px; display: block; }
}
@layer components {
  .icon-btn, .icon-btn * {
    text-overflow: clip !important;
    overflow: visible !important;
    white-space: normal !important;
  }
}

/* ========================= Badges / コメント抜粋 ========================= */
@layer components {
  .badge { @apply inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold ring-1; }
  .badge--ok   { @apply bg-emerald-100 text-emerald-800 ring-emerald-200; }
  .badge--ng   { @apply bg-rose-100 text-rose-800 ring-rose-200; }
  .badge--info { @apply bg-indigo-100 text-indigo-800 ring-indigo-200; }

  .record-comment {
    @apply text-sm text-gray-600 mt-0.5;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
}

/* ========================= 微調整（スクロール位置など） ========================= */
@layer utilities {
  .landing-root > .pull-up-after-flash { @apply -mt-4 sm:-mt-6; }
}
